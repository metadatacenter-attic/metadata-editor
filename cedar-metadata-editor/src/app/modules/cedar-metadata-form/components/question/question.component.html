<ng-container *ngIf="node.type == 'static';else notStaticType">
  <cedar-youtube *ngIf="node.subtype == 'youtube'" [formGroup]="formGroup" [node]="node"></cedar-youtube>
  <cedar-image *ngIf="node.subtype == 'image'" [formGroup]="formGroup" [node]="node"></cedar-image>
  <cedar-richtext *ngIf="node.subtype == 'richtext'" [formGroup]="formGroup" [node]="node"></cedar-richtext>
  <cedar-section *ngIf="node.subtype == 'section-break'" [formGroup]="formGroup" [node]="node"></cedar-section>
</ng-container>

<ng-template #notStaticType>
  <div [formGroup]="formGroup" class="form-group">

    <label class="question-label" [attr.for]="node.name">{{node.name}}</label>
    <button mat-icon-button class="help-text-button" *ngIf="node.help" [matTooltip]="node.help">
      <mat-icon>help_outline</mat-icon>
    </button>

<!--    {{node.model | json}}-->

    <div *ngIf="node.type == 'attribute-value' || node.type == 'list' || node.type == 'controlled' || node.type == 'checkbox' || node.type == 'radio'">

      <cedar-attribute-value *ngIf="node.type == 'attribute-value'" [formGroup]="formGroup" [node]="node"
        [disabled]="disabled"
        (changed)="onChange($event)"></cedar-attribute-value>

      <cedar-list *ngIf="node.type == 'list'" [formGroup]="formGroup" [node]="node"
        (changed)="onChange($event)"></cedar-list>

      <controlled *ngIf="node.type == 'controlled'" [group]="formGroup"
        [classLoader]="classLoader"
        [valueConstraints]="node.valueConstraints"
        (onRemovedOption)="onRemovedControlled($event)"
        (onSelectedOption)="onSelectedControlled($event)"></controlled>

      <cedar-checkbox *ngIf="node.type == 'checkbox'" [formGroup]="formGroup" [node]="node"
        (changed)="onChange($event)"></cedar-checkbox>

      <cedar-radio *ngIf="node.type == 'radio'" [formGroup]="formGroup" [node]="node"
        (changed)="onChange($event)"></cedar-radio>
    </div>

    <div *ngIf="allowsMultiple(node.type)">
      <div [ngSwitch]="node.type">
        <div *ngFor="let control of formGroup.controls['values']['controls'];index as i">

          <div *ngIf="node.multiSelect">
            {{node.name}} ({{(i + 1)}}  of {{ node.maxItems || 'N' }})
            <button mat-icon-button class="node-add" *ngIf="!disabled" (click)="addNewItem(i)">
              <mat-icon>add_circle_outline</mat-icon>
            </button>
            <button mat-icon-button class="node-remove" *ngIf="!disabled" (click)="deleteLastItem(i)">
              <mat-icon>remove_circle_outline</mat-icon>
            </button>
          </div>

          <cedar-textfield *ngSwitchCase="'textfield'" [formGroup]="formGroup" [control]="control" [node]="node"
            [index]="i" [disabled]="disabled" (changed)="onChange($event)"></cedar-textfield>

          <cedar-textarea *ngSwitchCase="'textarea'" [formGroup]="formGroup" [control]="control" [node]="node"
            [index]="i" (changed)="onChange($event)"></cedar-textarea>

          <cedar-date *ngSwitchCase="'date'" [formGroup]="formGroup" [control]="control" [node]="node" [index]="i"
            (changed)="onChange($event)"></cedar-date>
        </div>
      </div>
    </div>
  </div>
</ng-template>

