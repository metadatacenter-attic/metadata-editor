<script src="https://www.youtube.com/iframe_api"></script>

<h2>{{title}}</h2>

<form [formGroup]="form" *ngIf="form" class="cedar-form" >

  <div *ngIf="pageEvent.length > 1">
    <mat-paginator [length]="pageEvent.length"
      [pageSize]="1"
      [pageSizeOptions]="[1]"
      (page)="onPageChange($event)">
    </mat-paginator>
  </div>

  <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">

    <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
      <li class="mat-tree-node" [ngClass]="{'instance__container-dark': darkMode}">
        <button mat-icon-button disabled></button>
        <app-question [disabled]="viewOnly" [node]="node" [classLoader]="classLoader" [parentGroup]="node.formGroup"
          (changed)="onQuestionChanges($event)" style="width:100%"></app-question>
      </li>
    </mat-tree-node>
    <mat-nested-tree-node *matTreeNodeDef="let node; when: hasNestedChild">

      <li>
        <div class="mat-tree-node">
          <button mat-icon-button matTreeNodeToggle
            [attr.aria-label]="'toggle ' + node.filename">
            <mat-icon class="mat-icon-rtl-mirror">
              {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
            </mat-icon>
          </button>
          <span [matTooltip]="node.help">{{node.name}}</span>
          <span *ngIf="node.minItems" style="color:#222">
                  &nbsp;({{(node.itemCount + 1)}}  of {{ node.maxItems || 'N'}})
            <button mat-icon-button class="help-text-button" *ngIf="node.help" [matTooltip]="node.help"><mat-icon>help_outline</mat-icon></button>
        <button mat-icon-button class="node-add" *ngIf="!viewOnly" [matTooltip]="copy" (click)="addNewItem(node)"><mat-icon>add_circle_outline</mat-icon></button>
        <button mat-icon-button class="node-remove" *ngIf="!viewOnly" [matTooltip]="remove"
          (click)="deleteLastItem(node)"><mat-icon>remove_circle_outline</mat-icon></button>

                </span>
        </div>

        <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)" *ngIf="treeControl.isExpanded(node)">
          <app-element *ngIf="treeControl.isExpanded(node)" [node]="node" [parentGroup]="node.parentGroup"
            [formGroup]="node.formGroup"></app-element>
          <ng-container matTreeNodeOutlet></ng-container>
        </ul>

      </li>
    </mat-nested-tree-node>
  </mat-tree>
</form>


