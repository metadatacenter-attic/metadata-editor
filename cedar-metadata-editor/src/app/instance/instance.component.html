<div [ngClass]="{'instance__container-dark': darkMode}" class="instance__container example-tree" >

  <mat-tab-group>
    <mat-tab label="Form">

      <form [formGroup]="form" *ngIf="form">


        <mat-tree [dataSource]="dataSource" [treeControl]="treeControl">
          <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle>
            <li class="mat-tree-node" [ngClass]="{'instance__container-dark': darkMode}">
              <button mat-icon-button disabled></button>
              <app-question [node]="node" [parentGroup]="node.formGroup" style="width:100%"></app-question>
            </li>
          </mat-tree-node>
          <mat-nested-tree-node *matTreeNodeDef="let node; when: hasNestedChild">

            <li>
              <div class="mat-tree-node">
                <button mat-icon-button matTreeNodeToggle
                        [attr.aria-label]="'toggle ' + node.filename">
                  <mat-icon class="mat-icon-rtl-mirror">
                    {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
                  </mat-icon>
                </button>
                {{node.name}}
                <span *ngIf="node.minItems" style="padding:0 5px">
                  ({{(node.itemCount + 1)}}  of {{ node.maxItems || 'N'}})
                  <button mat-icon-button (click)="addNewItem(node)"><mat-icon>add</mat-icon></button>
                  <button mat-icon-button (click)="deleteLastItem(node)"><mat-icon>remove</mat-icon></button>
                </span>
              </div>

              <ul [class.example-tree-invisible]="!treeControl.isExpanded(node)">
                <app-element [node]="node" [parentGroup]="node.parentGroup" [formGroup]="node.formGroup"></app-element>
                <ng-container matTreeNodeOutlet></ng-container>
              </ul>

            </li>
          </mat-nested-tree-node>
        </mat-tree>


        <div>
          <button mat-raised-button color="primary" [disabled]="formInvalid"
                  (click)="onSubmit(form.value)">Save
          </button>
        </div>


      </form>

    </mat-tab>
    <mat-tab label="Value">
      <div *ngIf="payload">
        <pre>value: <span class="value">{{ payload | json}}</span></pre>
      </div>
    </mat-tab>
  </mat-tab-group>


</div>


